current path: saved_models/model_mnist_Jul.11_14.03.00
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [23, 76, 63, 11, 75, 43, 46, 37, 21, 35].
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1700, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch  11, local model 76, internal_epoch   1,  Average loss: 0.0016, Accuracy: 76/78 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.0849, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch  11, local model 63, internal_epoch   1,  Average loss: 0.0022, Accuracy: 856/889 (96.2880%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1833, Accuracy: 9429/10000 (94.2900%)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 626/645 (97.0543%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3061, Accuracy: 9026/10000 (90.2600%)
___Train Local_Simple,  epoch  11, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 666/686 (97.0845%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1533, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  11, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 395/408 (96.8137%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1539, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0027, Accuracy: 690/710 (97.1831%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5514, Accuracy: 8239/10000 (82.3900%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 839/860 (97.5581%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4315, Accuracy: 8705/10000 (87.0500%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0012, Accuracy: 305/312 (97.7564%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2237, Accuracy: 9317/10000 (93.1700%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 493/499 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1855, Accuracy: 9458/10000 (94.5800%)
time spent on training: 172.01316714286804
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.0826, Accuracy: 9730/10000 (97.3000%)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 12.2089, Accuracy: 41/8968 (0.4572%)
Done in 613.3382937908173 sec.
Server Epoch:12 choose agents : [41, 11, 61, 64, 28, 67, 22, 82, 60, 42].
poison local model 41 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0230, Accuracy: 367/606 (60.5611%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0171, Accuracy: 344/606 (56.7657%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   3,  Average loss: 0.0145, Accuracy: 378/606 (62.3762%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   4,  Average loss: 0.0130, Accuracy: 384/606 (63.3663%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   5,  Average loss: 0.0120, Accuracy: 405/606 (66.8317%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   6,  Average loss: 0.0118, Accuracy: 400/606 (66.0066%), train_poison_data_count: 200
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   7,  Average loss: 0.0111, Accuracy: 415/606 (68.4818%), train_poison_data_count: 200
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   8,  Average loss: 0.0113, Accuracy: 391/606 (64.5215%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch   9,  Average loss: 0.0110, Accuracy: 421/606 (69.4719%), train_poison_data_count: 200
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 41, internal_epoch  10,  Average loss: 0.0107, Accuracy: 411/606 (67.8218%), train_poison_data_count: 200
Global model norm: 16.536208680038047.
Norm before scaling: 16.671140045011636. Distance: 4.382063259334976
will scale.
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.6635, Accuracy: 3911/10000 (39.1100%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8101, Accuracy: 6128/8968 (68.3318%)
Scaling by  100
Scaled Norm after poisoning: 436.83640745134784, distance: 438.2063405235027
Total norm for 1 adversaries is: 436.83640745134784. distance: 438.2063405235027
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 67869.0983, Accuracy: 4574/8968 (51.0036%)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 631/645 (97.8295%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2689, Accuracy: 9091/10000 (90.9100%)
___Train Local_Simple,  epoch  12, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 679/699 (97.1388%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2395, Accuracy: 9225/10000 (92.2500%)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0017, Accuracy: 789/813 (97.0480%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3925, Accuracy: 8703/10000 (87.0300%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 486/501 (97.0060%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1043, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch  12, local model 67, internal_epoch   1,  Average loss: 0.0013, Accuracy: 973/998 (97.4950%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2071, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch  12, local model 22, internal_epoch   1,  Average loss: 0.0013, Accuracy: 570/583 (97.7702%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2139, Accuracy: 9312/10000 (93.1200%)
___Train Local_Simple,  epoch  12, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 694/713 (97.3352%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9529, Accuracy: 7035/10000 (70.3500%)
___Train Local_Simple,  epoch  12, local model 60, internal_epoch   1,  Average loss: 0.0020, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1482, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 231/236 (97.8814%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1091, Accuracy: 9655/10000 (96.5500%)
time spent on training: 303.01212668418884
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.6579, Accuracy: 3900/10000 (39.0000%)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.8141, Accuracy: 6128/8968 (68.3318%)
Done in 326.78266763687134 sec.
Server Epoch:13 choose agents : [85, 56, 57, 63, 77, 18, 43, 91, 42, 52].
___Train Local_Simple,  epoch  13, local model 85, internal_epoch   1,  Average loss: 0.0123, Accuracy: 325/431 (75.4060%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9604, Accuracy: 7475/10000 (74.7500%)
___Train Local_Simple,  epoch  13, local model 56, internal_epoch   1,  Average loss: 0.0089, Accuracy: 753/880 (85.5682%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6396, Accuracy: 8481/10000 (84.8100%)
___Train Local_Simple,  epoch  13, local model 57, internal_epoch   1,  Average loss: 0.0121, Accuracy: 249/343 (72.5948%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7616, Accuracy: 7272/10000 (72.7200%)
___Train Local_Simple,  epoch  13, local model 63, internal_epoch   1,  Average loss: 0.0091, Accuracy: 718/889 (80.7649%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2903, Accuracy: 9173/10000 (91.7300%)
___Train Local_Simple,  epoch  13, local model 77, internal_epoch   1,  Average loss: 0.0109, Accuracy: 472/589 (80.1358%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3715, Accuracy: 8921/10000 (89.2100%)
___Train Local_Simple,  epoch  13, local model 18, internal_epoch   1,  Average loss: 0.0142, Accuracy: 337/459 (73.4205%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.5960, Accuracy: 6919/10000 (69.1900%)
___Train Local_Simple,  epoch  13, local model 43, internal_epoch   1,  Average loss: 0.0116, Accuracy: 315/408 (77.2059%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6745, Accuracy: 8151/10000 (81.5100%)
___Train Local_Simple,  epoch  13, local model 91, internal_epoch   1,  Average loss: 0.0129, Accuracy: 181/256 (70.7031%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.3719, Accuracy: 6104/10000 (61.0400%)
___Train Local_Simple,  epoch  13, local model 42, internal_epoch   1,  Average loss: 0.0181, Accuracy: 142/236 (60.1695%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2359, Accuracy: 5262/10000 (52.6200%)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0164, Accuracy: 165/253 (65.2174%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.5084, Accuracy: 4580/10000 (45.8000%)
time spent on training: 161.80683064460754
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.3059, Accuracy: 5165/10000 (51.6500%)
